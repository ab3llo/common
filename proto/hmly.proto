syntax = "proto3";

option go_package = "github.com/hmlylab/common/proto";

import "google/api/annotations.proto";

package api;

service HouseholdService {
    rpc CreateHousehold(CreateHouseholdRequest) returns (HouseholdResponse) {
        option (google.api.http) = {
            post: "/v1/households"
            body: "*"
        };
    };
    rpc GetHousehold(GetHouseholdRequest) returns (HouseholdResponse) {
        option (google.api.http) = {
            get: "/v1/households/{id}"
        };
    };
    rpc GetHouseholds(GetHouseHoldsRequest) returns (HouseholdsResponse){
        option (google.api.http) = {
            get: "/v1/households/{offset}/{limit}"
        };
    };
    rpc UpdateHousehold(UpdateHouseholdRequest) returns (HouseholdResponse){
        option (google.api.http) = {
            put: "/v1/households/{id}"
            body: "*"
        };
    };
    rpc DeleteHousehold(GetHouseholdRequest) returns (HouseholdResponse){
        option (google.api.http) = {
            delete: "/v1/households/{id}"
        };
    };
}

service MemberService {
    rpc CreateMember(CreateMemberRequest) returns (MemberResponse){
        option (google.api.http) = {
            post: "/v1/members"
            body: "*"
        };
    };
    rpc GetMember(GetMemberRequest) returns (MemberResponse){
        option (google.api.http) = {
            get: "/v1/members/{id}"
        };
    };
    rpc GetMembers(GetMembersRequest) returns (MembersResponse){
        option (google.api.http) = {
            get: "/v1/members/household/{household_id}"
        };
    };
    rpc UpdateMember(UpdateMemberRequest) returns (MemberResponse){
        option (google.api.http) = {
            put: "/v1/members/{id}"
            body: "*"
        };
    };
    rpc DeleteMember(GetMemberRequest) returns (MemberResponse){
        option (google.api.http) = {
            delete: "/v1/members/{id}"
        };
    };
}

service MealService {
    rpc CreateMeal(CreateMealRequest) returns (MealResponse){
        option (google.api.http) = {
            post: "/v1/meals"
            body: "*"
        };
    };
    rpc GetMeal(GetMealRequest) returns (MealResponse){
        option (google.api.http) = {
            get: "/v1/meals/{id}"
        };
    };
    rpc GetMeals(GetMealsRequest) returns (MealsResponse){
        option (google.api.http) = {
            get: "/v1/meals/household/{household_id}"
        };
    };
    rpc UpdateMeal(UpdateMealRequest) returns (MealResponse){
        option (google.api.http) = {
            put: "/v1/meals/{id}"
            body: "*"
        };
    };
    rpc DeleteMeal(GetMealRequest) returns (MealResponse){
        option (google.api.http) = {
            delete: "/v1/meals/{id}"
        };
    };
}

service EventService {
    rpc CreateEvent(CreateEventRequest) returns (EventResponse){
        option (google.api.http) = {
            post: "/v1/events"
            body: "*"
        };
    };
    rpc GetEvent(GetEventRequest) returns (EventResponse){
        option (google.api.http) = {
            get: "/v1/events/{id}"
        };
    };
    rpc GetEvents(GetEventsRequest) returns (EventsResponse){
        option (google.api.http) = {
            get: "/v1/events/entity/{entityType}/{offset}/{limit}"
        };
    };
    rpc UpdateEvent(UpdateEventRequest) returns (EventResponse){
        option (google.api.http) = {
            put: "/v1/events/{id}"
            body: "*"
        };
    };
    rpc DeleteEvent(GetEventRequest) returns (EventResponse){
        option (google.api.http) = {
            delete: "/v1/events/{id}"
        };
    };
}   

message CreateHouseholdRequest {
    string name = 1;
}

message GetHouseholdRequest {
    string id = 1;
}

message GetHouseHoldsRequest {
    int32 offset = 1;
    int32 limit = 2;
}

message UpdateHouseholdRequest {
    string id = 1;
    string name = 2;
}

message CreateHouseholdResponse {
    string id = 1;
    string name = 2;
    optional Error error_message = 3;
}

message HouseholdResponse {
    string id = 1;
    string name = 2;
    optional Error error_message = 3;
    string created_at = 4;
    string updated_at = 5;
}

message Error {
    int32 code = 1;
    string message = 2;
}

message HouseholdsResponse {
    repeated HouseholdResponse households = 1;
    optional Error error_message = 2;
}

message CreateMemberRequest {
    string household_id = 1;
    string user_id = 2;
}

message GetMemberRequest {
    string id = 1;
}

message GetMembersRequest {
    string household_id = 1;
}

message UpdateMemberRequest {
    string id = 1;
    string household_id = 2;
    string user_id = 3;
}

message MemberResponse {
    string id = 1;
    string household_id = 2;
    string user_id = 3;
    optional Error error_message = 4;
    string created_at = 5;
    string updated_at = 6;
}

message MembersResponse {
    repeated MemberResponse members = 1;
    optional Error error_message = 2;
}

message CreateMealRequest {
    string name = 1;
    string household_id = 2;
}   


message GetMealRequest {
    string id = 1;
}

message GetMealsRequest {
    string household_id = 1;
}

message UpdateMealRequest {
    string id = 1;
    string name = 2;
    string household_id = 4;
}

message MealResponse {
    string id = 1;
    string name = 2;
    string household_id = 3;
    optional Error error_message = 4;
    string created_at = 5;
    string updated_at = 6;
}

message MealsResponse {
    repeated MealResponse meals = 1;
    optional Error error_message = 2;
}

message CreateEventRequest {
    string name = 1;
    string entity_id = 2;
    string entity_type = 3;
    string start_date = 4;
    string end_date = 5;
    string assigned_to = 6;
}

message GetEventRequest {
    string id = 1;
}   

message GetEventsRequest {
    string entityType = 1;
    int32 offset = 2;
    int32 limit = 3;
}

message UpdateEventRequest {
    string id = 1;
    string name = 2;
    string entity_id = 3;
    string entity_type = 4;
    string start_date = 5;
    string end_date = 6;
    string assigned_to = 7;
}

message EventResponse {
    string id = 1;
    string name = 2;
    string entity_id = 3;
    string entity_type = 4;
    string start_date = 5;
    string end_date = 6;
    string assigned_to = 7;
    optional Error error_message = 8;
    string created_at = 9;
    string updated_at = 10;
}

message EventsResponse {
    repeated EventResponse events = 1;
    optional Error error_message = 2;
}

message VerifyTokenRequest {
    string token = 1;
}   

message VerifyTokenResponse {
    bool valid = 1;
    string user_id = 2;
    optional Error error_message = 3;
}